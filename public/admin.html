<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–ê–¥–º–∏–Ω ‚Äî –∑–∞—è–≤–∫–∏</title>
  <link rel="stylesheet" href="style.css">
  <style>
    table { width:100%; border-collapse: collapse; }
    th,td { border:1px solid #ccc; padding:.4rem; font-size:.85rem; }
    th { background:#eee; }
  </style>
</head>
<body>
  <h2>üìã –ü–æ–ª—É—á–µ–Ω–Ω—ã–µ –∞–Ω–∫–µ—Ç—ã (live)</h2>
  <table id="tbl">
    <thead>
      <tr><th>–ö–æ–≥–¥–∞</th><th>–ö–æ–Ω—Ç–∞–∫—Ç</th><th>–ì–¥–µ –∂–∏–≤—ë—Ç</th><th>–ì–¥–µ —É—á–∏—Ç—Å—è</th><th>–ï—Å—Ç—å –¥–∞—á–∞?</th></tr>
    </thead>
    <tbody></tbody>
  </table>

  <!-- Socket.io –∫–ª–∏–µ–Ω—Ç -->
  <script src="/socket.io/socket.io.js"></script>
  <script>
    const tbody = document.querySelector('#tbl tbody');
    const socket = io();

    // –Ω–∞—á–∞–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞
    socket.on('init', list => list.forEach(addRow));

    // –Ω–æ–≤—ã–µ –∑–∞—è–≤–∫–∏
    socket.on('new-submission', addRow);

    function addRow(d){
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${new Date(d.createdAt).toLocaleString()}</td>
        <td>${d.contact || ''}</td>
        <td>${d.address || ''}</td>
        <td>${d.school  || ''}</td>
        <td>${d.dacha   || ''}</td>`;
      tbody.prepend(tr);
    }
  </script>
</body>
</html>